<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BANGKEI ðŸ”« | MOD DISTRIBUTION</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Poppins:wght@400;600&display=swap');

        :root { 
            --primary: #ff9d00; 
            --bg: #0a0a0a; 
            --card: rgba(21, 21, 21, 0.85); 
            --text: #ffffff; 
        }
        
        body { 
            background-color: var(--bg); 
            color: var(--text); 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            padding: 40px 10px; 
            min-height: 100vh;
            position: relative;
            background-image: url('https://i.postimg.cc/Vvk89HGm/3ff71d480e24ec7af86d74812e609089.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .wrapper { width: 100%; max-width: 500px; text-align: center; background: transparent; padding: 20px; margin-bottom: 80px; }
        
        .profile-pic {
            width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--primary);
            object-fit: cover; margin-bottom: 10px; box-shadow: 0 0 15px var(--primary);
        }

        .profile-header h1 { font-family: 'Oswald', sans-serif; font-size: 3.5rem; color: var(--primary); margin: 5px 0; text-shadow: 4px 4px #000; }
        .tagline { color: #eee; text-transform: uppercase; font-size: 0.85rem; margin-bottom: 10px; font-weight: bold; text-shadow: 1px 1px 2px #000; }

        .visitor-counter {
            font-size: 0.75rem; color: var(--primary); background: rgba(0,0,0,0.6);
            display: inline-block; padding: 4px 12px; border-radius: 20px; margin-bottom: 20px; border: 1px solid var(--primary);
        }

        .social-icons { display: flex; justify-content: center; gap: 20px; margin-bottom: 25px; }
        .social-icons a { color: var(--text); font-size: 1.6rem; transition: 0.3s; text-shadow: 2px 2px 4px #000; }
        .social-icons a:hover { color: var(--primary); transform: scale(1.2); }

        .category-tab { display: flex; justify-content: space-around; background: var(--card); padding: 10px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #444; }
        .tab-btn { background: none; border: none; color: #bbb; font-weight: bold; cursor: pointer; font-family: 'Oswald', sans-serif; font-size: 1rem; }
        .tab-btn.active { color: var(--primary); text-decoration: underline; text-underline-offset: 5px; }

        .link-container { display: flex; flex-direction: column; gap: 12px; min-height: 200px; }
        .mod-card { 
            background: var(--card); border-left: 5px solid var(--primary); padding: 15px 20px; 
            cursor: pointer; display: flex; justify-content: space-between; align-items: center; border-radius: 4px; transition: 0.2s; 
        }
        .mod-card:hover { background: rgba(30, 30, 30, 0.95); transform: translateX(5px); }
        .mod-info { text-align: left; flex-grow: 1; }
        .mod-info span.mod-cat { font-size: 0.7rem; color: var(--primary); display: block; font-weight: bold; text-transform: uppercase; }
        .mod-info strong { font-size: 1.1rem; text-transform: uppercase; color: white; display: block; margin: 2px 0; }
        .mod-divider { height: 1px; background: linear-gradient(to right, rgba(255, 157, 0, 0.5), transparent); margin: 6px 0; width: 80%; }
        .mod-desc-text { font-size: 0.85rem; color: #ddd; display: block; font-style: italic; }

        #download-popup { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; }
        .popup-box { background: #111; padding: 30px; border: 2px solid var(--primary); width: 85%; max-width: 350px; text-align: center; border-radius: 15px; }

        #admin-panel { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: transparent; backdrop-filter: blur(10px); z-index: 3000; 
            padding: 20px; box-sizing: border-box; overflow-y: auto; 
            justify-content: center; align-items: flex-start; 
        }
        .admin-content-wrapper {
            background: rgba(0,0,0,0.9); border-radius: 15px; padding: 20px; 
            max-width: 450px; width: 100%; border: 1px solid var(--primary); margin-top: 20px;
        }
        .admin-card { background: #111; border: 1px solid #222; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: var(--primary); border-radius: 5px; box-sizing: border-box; }
        
        .admin-trigger-icon {
            position: fixed; bottom: 25px; right: 20px; background: rgba(0,0,0,0.7); 
            border: 1px solid var(--primary); color: var(--primary); width: 40px; height: 40px; 
            border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 1001;
        }
        .footer { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.8); color: #aaa; font-size: 0.8rem; padding: 12px 0; text-align: center; z-index: 999; font-weight: bold; }
        
        /* Loading Overlay */
        #loading-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:4000; justify-content:center; align-items:center; color:white; }
    </style>
</head>
<body>

<div id="loading-overlay">Memproses ke Google Sheets...</div>

<div class="wrapper">
    <div class="profile-header">
        <img id="main-photo" src="https://i.postimg.cc/QNvrRVw0/20260208-193044.jpg" class="profile-pic" alt="Keinox">
        <h1>BANGKEI</h1>
        <p class="tagline">nih link nya kalo mau donlot</p>
    </div>
    <div class="visitor-counter"><i class="fas fa-users"></i> <span id="count-display">0</span> Orang sudah mampir</div>
    <div class="social-icons" id="social-display"></div>
    <div class="category-tab">
        <button class="tab-btn active" onclick="switchTab('Monetloader', this)">MONETLOADER</button>
        <button class="tab-btn" onclick="switchTab('Cleo', this)">CLEO</button>
        <button class="tab-btn" onclick="switchTab('Modpack', this)">MODPACK</button>
    </div>
    <div id="links-display" class="link-container"></div>
</div>

<div class="admin-trigger-icon" onclick="openAdmin()"><i class="fas fa-lock"></i></div>
<div class="footer">Made in 2026 | Keinox</div>

<div id="download-popup">
    <div class="popup-box">
        <h3 id="pop-title" style="color:var(--primary); margin:0 0 10px 0; font-family:'Oswald';">FILE</h3>
        <button class="btn" style="width:100%; padding:14px; background:var(--primary); border:none; border-radius:5px; font-weight:bold; cursor:pointer;" id="confirm-btn">OKE BANG</button>
        <button class="btn" style="width:100%; padding:14px; background:#333; color:white; border:none; border-radius:5px; margin-top:10px; cursor:pointer;" onclick="closePopup()">BATAL</button>
    </div>
</div>

<div id="admin-panel">
    <div class="admin-content-wrapper">
        <h2 style="color: var(--primary); font-family:'Oswald'; text-align:center;">ADMIN DASHBOARD</h2>
        
        <div id="auth-section" class="admin-card">
            <input type="password" id="admin-pass" placeholder="Password Access">
            <button style="width:100%; padding:14px; background:var(--primary); border:none; border-radius:5px; font-weight:bold;" onclick="checkPass()">LOGIN KEINOX</button>
        </div>

        <div id="control-section" style="display: none;">
            <div class="admin-card">
                <h4 style="color:var(--primary); margin:0;">UPLOAD FILE</h4>
                <select id="mod-cat">
                    <option value="Monetloader">Monetloader</option>
                    <option value="Cleo">Cleo</option>
                    <option value="Modpack">Modpack</option>
                </select>
                <input type="text" id="mod-name" placeholder="Nama File">
                <input type="text" id="mod-url" placeholder="Link Download">
                <textarea id="mod-desc" placeholder="Deskripsi Singkat"></textarea>
                <button style="width:100%; padding:12px; background:var(--primary); border:none; border-radius:5px; font-weight:bold;" onclick="addMod()">TAMBAHKAN</button>
            </div>

            <div class="admin-card">
                <h4 style="color:var(--primary); margin:0;">LINK MEDIA SOSIAL</h4>
                <input type="text" id="yt-link" placeholder="Link YouTube">
                <input type="text" id="tt-link" placeholder="Link TikTok">
                <input type="text" id="dc-link" placeholder="Link Discord">
                <input type="text" id="sw-link" placeholder="Link Saweria">
                <button style="width:100%; padding:12px; background:var(--primary); border:none; border-radius:5px; font-weight:bold;" onclick="saveSocials()">UPDATE SOSMED</button>
            </div>

            <div class="admin-card">
                <h4 style="color:var(--primary); margin:0;">TAMPILAN</h4>
                <input type="text" id="photo-url" placeholder="Link Foto Profil Baru">
                <label style="font-size: 0.8rem; color:#888;">Warna Tema:</label>
                <input type="color" id="theme-color" style="height:45px;">
                <button style="width:100%; padding:12px; background:var(--primary); border:none; border-radius:5px; font-weight:bold;" onclick="saveSettings()">SIMPAN TAMPILAN</button>
            </div>

            <div id="admin-edit-list"></div>
        </div>
        <button style="width:100%; padding:14px; background:#ff4444; color:white; border:none; border-radius:5px; margin-top:10px; font-weight:bold;" onclick="closeAdmin()">KELUAR</button>
    </div>
</div>

<script>
    // MASUKKAN URL WEB APP GOOGLE SCRIPT ANDA DI SINI
    const SCRIPT_URL = "URL_SCRIPT_GOOGLE_SHEETS_KAMU"; 
    
    const PASS = "210213";
    let currentTab = "Monetloader";
    
    // Inisialisasi Database (Local Settings & Global Mods)
    let db = JSON.parse(localStorage.getItem('bangkei_pro_v2')) || {
        mods: [],
        socials: {yt: "#", tt: "#", dc: "#", sw: "#"},
        theme: "#ff9d00",
        photo: "https://i.postimg.cc/QNvrRVw0/20260208-193044.jpg",
        visitors: 0
    };

    // FUNGSI BARU: Ambil Data dari Google Sheets
    async function loadFromSheets() {
        try {
            const response = await fetch(SCRIPT_URL);
            const data = await response.json();
            db.mods = data; // Ganti mod local dengan data dari Sheets
            render();
        } catch (e) {
            console.log("Gagal memuat dari Sheets, menggunakan data lokal.");
            render();
        }
    }

    function updateVisitors() {
        if (!sessionStorage.getItem('session_active')) {
            db.visitors = (db.visitors || 0) + 1;
            localStorage.setItem('bangkei_pro_v2', JSON.stringify(db));
            sessionStorage.setItem('session_active', 'true');
        }
        document.getElementById('count-display').innerText = db.visitors;
    }

    function applyTheme() {
        document.documentElement.style.setProperty('--primary', db.theme);
        document.getElementById('main-photo').src = db.photo;
        document.getElementById('photo-url').value = db.photo;
        document.getElementById('theme-color').value = db.theme;
        document.getElementById('yt-link').value = db.socials.yt;
        document.getElementById('tt-link').value = db.socials.tt;
        document.getElementById('dc-link').value = db.socials.dc;
        document.getElementById('sw-link').value = db.socials.sw;
    }

    function render() {
        applyTheme();
        const lDisplay = document.getElementById('links-display');
        const sDisplay = document.getElementById('social-display');
        const eList = document.getElementById('admin-edit-list');
        
        lDisplay.innerHTML = '';
        sDisplay.innerHTML = `
            <a href="${db.socials.yt}" target="_blank"><i class="fab fa-youtube"></i></a>
            <a href="${db.socials.tt}" target="_blank"><i class="fab fa-tiktok"></i></a>
            <a href="${db.socials.dc}" target="_blank"><i class="fab fa-discord"></i></a>
            <a href="${db.socials.sw}" target="_blank"><i class="fas fa-donate"></i></a>`;

        const filtered = db.mods.filter(m => m.category === currentTab);
        if(filtered.length === 0) lDisplay.innerHTML = `<p style="color:#eee; margin-top:50px;">Kosong, Bang.</p>`;

        filtered.forEach((m) => {
            const descHtml = m.desc ? `<div class="mod-divider"></div><span class="mod-desc-text">${m.desc}</span>` : '';
            lDisplay.innerHTML += `<div class="mod-card" onclick="openPopup('${m.name}', '${m.url}')">
                <div class="mod-info"><span class="mod-cat">${m.category}</span><strong>${m.name}</strong>${descHtml}</div>
                <i class="fas fa-download download-icon"></i></div>`;
        });

        eList.innerHTML = '<h4 style="color:white; border-bottom:1px solid #333;">LIST FILE (SYNCED):</h4>';
        db.mods.forEach((m, i) => {
            eList.innerHTML += `<div style="display:flex; justify-content:space-between; background:#222; padding:8px; margin-top:5px; border-radius:5px; font-size:0.8rem;">
                <span>${m.name}</span><button onclick="delMod('${m.name}')" style="color:red; background:none; border:none; cursor:pointer;">HAPUS</button></div>`;
        });
        localStorage.setItem('bangkei_pro_v2', JSON.stringify(db));
    }

    function openAdmin() { document.getElementById('admin-panel').style.display = 'flex'; }
    function closeAdmin() { document.getElementById('admin-panel').style.display = 'none'; }
    
    function checkPass() {
        if(document.getElementById('admin-pass').value === PASS) {
            document.getElementById('auth-section').style.display = 'none';
            document.getElementById('control-section').style.display = 'block';
        } else { alert("PASS SALAH!"); }
    }

    // MODIFIKASI: Tambah data ke Google Sheets
    async function addMod() {
        const n = document.getElementById('mod-name').value;
        const u = document.getElementById('mod-url').value;
        const c = document.getElementById('mod-cat').value;
        const d = document.getElementById('mod-desc').value;
        
        if(n && u) { 
            document.getElementById('loading-overlay').style.display = 'flex';
            const payload = { action: "add", category: c, name: n, url: u, desc: d };
            
            try {
                await fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(payload) });
                document.getElementById('mod-name').value = '';
                document.getElementById('mod-url').value = '';
                document.getElementById('mod-desc').value = '';
                await loadFromSheets(); // Refresh data
            } catch (e) { alert("Gagal Simpan ke Sheets!"); }
            
            document.getElementById('loading-overlay').style.display = 'none';
        }
    }

    // MODIFIKASI: Hapus data dari Google Sheets
    async function delMod(name) {
        if(confirm("Hapus file ini secara permanen?")) {
            document.getElementById('loading-overlay').style.display = 'flex';
            const payload = { action: "delete", name: name };
            try {
                await fetch(SCRIPT_URL, { method: "POST", body: JSON.stringify(payload) });
                await loadFromSheets();
            } catch (e) { alert("Gagal Hapus!"); }
            document.getElementById('loading-overlay').style.display = 'none';
        }
    }

    function saveSocials() {
        db.socials.yt = document.getElementById('yt-link').value;
        db.socials.tt = document.getElementById('tt-link').value;
        db.socials.dc = document.getElementById('dc-link').value;
        db.socials.sw = document.getElementById('sw-link').value;
        render(); alert("Sosmed Diupdate!");
    }

    function saveSettings() {
        db.theme = document.getElementById('theme-color').value;
        db.photo = document.getElementById('photo-url').value;
        render(); alert("Tampilan Diupdate!");
    }

    function switchTab(cat, btn) {
        currentTab = cat;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        render();
    }

    function openPopup(n, u) { 
        document.getElementById('pop-title').innerText = n;
        document.getElementById('download-popup').style.display = 'flex';
        document.getElementById('confirm-btn').onclick = () => { window.open(u, '_blank'); closePopup(); };
    }
    function closePopup() { document.getElementById('download-popup').style.display = 'none'; }

    // Jalankan saat pertama kali buka
    updateVisitors();
    loadFromSheets(); 
</script>
</body>
</html>
