<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BANGKEI ðŸ”« | MOD DISTRIBUTION</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Poppins:wght@400;600&display=swap');
        :root { --primary: #ff9d00; --bg: #0a0a0a; --card: rgba(21, 21, 21, 0.9); --text: #ffffff; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Poppins', sans-serif; margin: 0; display: flex; justify-content: center; padding: 40px 10px; min-height: 100vh; background-size: cover; background-position: center; background-attachment: fixed; }
        .wrapper { width: 100%; max-width: 500px; text-align: center; padding-bottom: 100px; position: relative; }
        .help-btn { position: absolute; top: -20px; right: 10px; color: var(--primary); font-size: 1.5rem; cursor: pointer; z-index: 100; }
        .profile-pic { width: 110px; height: 110px; border-radius: 50%; border: 3px solid var(--primary); object-fit: cover; margin-bottom: 10px; box-shadow: 0 0 15px var(--primary); }
        .profile-header h1 { font-family: 'Oswald', sans-serif; font-size: 3rem; color: var(--primary); margin: 5px 0; text-shadow: 3px 3px #000; }
        .visitor-counter { font-size: 0.75rem; color: #fff; background: rgba(0,0,0,0.8); display: inline-flex; align-items: center; gap: 8px; padding: 5px 15px; border-radius: 50px; margin-bottom: 20px; border: 1px solid var(--primary); }
        .search-box input { background: rgba(0,0,0,0.8); border: 1px solid var(--primary); color: white; padding: 12px; border-radius: 8px; width: 90%; outline: none; }
        .category-tab { display: flex; justify-content: space-around; background: var(--card); padding: 8px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #444; overflow-x: auto; }
        .tab-btn { background: none; border: none; color: #bbb; font-weight: bold; cursor: pointer; font-family: 'Oswald', sans-serif; font-size: 0.8rem; white-space: nowrap; padding: 5px 15px; }
        .tab-btn.active { color: var(--primary); border-bottom: 2px solid var(--primary); }
        .link-container { display: flex; flex-direction: column; gap: 12px; }
        .mod-card { background: var(--card); border-left: 4px solid var(--primary); padding: 10px; cursor: pointer; display: flex; align-items: center; gap: 12px; border-radius: 8px; }
        .mod-img-preview { width: 60px; height: 60px; border-radius: 8px; object-fit: cover; border: 1px solid #444; }
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 5000; justify-content: center; align-items: center; padding: 20px; backdrop-filter: blur(5px); }
        .modal-box { background: #111; padding: 25px; border: 2px solid var(--primary); width: 100%; max-width: 350px; text-align: center; border-radius: 15px; }
        #admin-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; padding: 20px; flex-direction: column; align-items: center; overflow-y: auto; }
        .admin-box { width: 100%; max-width: 400px; background: #111; border: 1px solid var(--primary); padding: 20px; border-radius: 15px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: var(--primary); border-radius: 8px; box-sizing: border-box; }
        .admin-btn { width: 100%; padding: 12px; background: var(--primary); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 5px; color: #000; }
        .footer { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.9); color: #aaa; font-size: 0.75rem; padding: 12px 0; text-align: center; }
    </style>
</head>
<body id="body-bg">

<script>
    // FUNGSI HARUS DI ATAS AGAR TIDAK ERROR "NOT DEFINED"
    var currentTab = "Monetloader";
    var sheetData = [];
    var db = JSON.parse(localStorage.getItem('bangkei_v14_final')) || {
        bg: "https://i.postimg.cc/Vvk89HGm/3ff71d480e24ec7af86d74812e609089.jpg",
        photo: "https://i.postimg.cc/QNvrRVw0/20260208-193044.jpg",
        adImg: "https://i.postimg.cc/Vvk89HGm/3ff71d480e24ec7af86d74812e609089.jpg",
        adLink: "#", helpText: "Cari mod lalu download. Hubungi Keinox!",
        name: "BANGKEI", tag: "nih link nya kalo mau donlot",
        theme: "#ff9d00", visitors: 0, sosmed: { yt: "#", tt: "#", dc: "#", sw: "#" }, mods: []
    };

    function save() { localStorage.setItem('bangkei_v14_final', JSON.stringify(db)); }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    
    function render() {
        document.documentElement.style.setProperty('--primary', db.theme);
        document.getElementById('body-bg').style.backgroundImage = "url('" + db.bg + "')";
        document.getElementById('main-photo').src = db.photo;
        document.getElementById('ad-img').src = db.adImg;
        document.getElementById('web-name').innerText = db.name;
        document.getElementById('web-tag').innerText = db.tag;
        document.getElementById('count-display').innerText = db.visitors;
        
        // Buat link di bantuan bisa ditekan
        var linkedHelp = db.helpText.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color:var(--primary)">$1</a>');
        document.getElementById('help-content').innerHTML = linkedHelp.replace(/\n/g, '<br>');

        var container = document.getElementById('links-display');
        container.innerHTML = "";
        var allMods = [...db.mods, ...sheetData];
        var filtered = allMods.filter(m => m.category === currentTab);
        
        filtered.forEach(m => {
            container.innerHTML += `<div class="mod-card" onclick="window.open('${m.url}','_blank')">
                <img src="${m.img || ''}" class="mod-img-preview">
                <div style="text-align:left;flex:1;"><strong>${m.name}</strong><br><small>${m.desc || ''}</small></div>
                <i class="fas fa-download"></i>
            </div>`;
        });
    }

    function switchTab(cat, btn) {
        currentTab = cat;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        render();
    }

    function checkPass() {
        if(document.getElementById('pass-in').value === "210213") {
            closeModal('login-popup');
            document.getElementById('admin-panel').style.display = 'flex';
        } else { alert("Salah!"); }
    }

    function saveAdmin() {
        db.photo = document.getElementById('in-photo').value;
        db.adImg = document.getElementById('in-ad-img').value;
        db.adLink = document.getElementById('in-ad-link').value;
        db.helpText = document.getElementById('in-help').value;
        save(); render(); alert("Tersimpan!");
    }

    window.onload = function() {
        if(!sessionStorage.getItem('v')) { db.visitors++; save(); sessionStorage.setItem('v', '1'); }
        render();
        // LINK SHEETS ABANG
        var csv = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS-WXy-au3TmKpigPhwRidm2sFr_MscMUwlJDGLDNfOv-0gmG7S4wXY866LPQkR4fvhzzfmyEeAHJdb/pub?output=csv';
        Papa.parse(csv, {
            download: true, header: true,
            complete: function(res) {
                sheetData = res.data.map(m => ({ name:m.Nama, url:m.Link, category:m.Category, img:m.Foto, desc:m.Deskripsi }));
                render();
            }
        });
    };
</script>

<div class="wrapper">
    <div class="help-btn" onclick="document.getElementById('help-popup').style.display='flex'"><i class="fas fa-question-circle"></i></div>
    <div class="profile-header">
        <img id="main-photo" src="" class="profile-pic">
        <h1 id="web-name"></h1>
        <p id="web-tag"></p>
    </div>
    <div class="visitor-counter"><i class="fas fa-eye"></i> <span id="count-display">0</span> Visitor</div>
    <div class="category-tab">
        <button class="tab-btn active" onclick="switchTab('Monetloader', this)">MONET</button>
        <button class="tab-btn" onclick="switchTab('Cleo', this)">CLEO</button>
        <button class="tab-btn" onclick="switchTab('Modpack', this)">MODPACK</button>
    </div>
    <div id="links-display" class="link-container"></div>
</div>

<div id="login-popup" class="modal-overlay"><div class="modal-box"><h3>ADMIN</h3><input type="password" id="pass-in"><button class="admin-btn" onclick="checkPass()">LOGIN</button></div></div>
<div id="help-popup" class="modal-overlay"><div class="modal-box"><h3>BANTUAN</h3><p id="help-content"></p><button class="admin-btn" onclick="closeModal('help-popup')">OKE</button></div></div>
<div id="ad-popup" class="modal-overlay" style="display:flex;"><div class="modal-box">
    <img id="ad-img" onclick="if(db.adLink!='#') window.open(db.adLink,'_blank')" style="width:100%; border-radius:10px; cursor:pointer;">
    <button class="admin-btn" onclick="closeModal('ad-popup')">TUTUP IKLAN</button>
</div></div>

<div id="admin-panel">
    <div class="admin-box">
        <h3>OWNER SETTING</h3>
        <input type="text" id="in-photo" placeholder="Link Foto Profil (Direct Link)">
        <input type="text" id="in-ad-img" placeholder="Link Foto Iklan">
        <input type="text" id="in-ad-link" placeholder="Link Klik Iklan">
        <textarea id="in-help" placeholder="Text Bantuan"></textarea>
        <button class="admin-btn" onclick="saveAdmin()">SIMPAN</button>
        <button class="admin-btn" style="background:#333;color:#fff;" onclick="closeModal('admin-panel')">KELUAR</button>
    </div>
</div>

<div class="footer">Made by <span onclick="document.getElementById('login-popup').style.display='flex'" style="color:var(--primary);cursor:pointer;">Keinox</span></div>

</body>
</html>
